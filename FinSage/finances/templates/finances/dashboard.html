<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - FinSage</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');

        :root {
            --primary-color: #0f766e;
            --primary-dark: #134e4a;
            --secondary-color: #0d9488;
            --accent-color: #2dd4bf;
            --text-color: #1e293b;
            --light-bg: #f8fafc;
            --white: #ffffff;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        body {
            background-color: var(--light-bg);
            color: var(--text-color);
            min-height: 100vh;
        }

        .header {
            background-color: var(--primary-color);
            padding: 1rem 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo-container img {
            height: 50px;
        }

        .brand-name {
            color: var(--white);
            font-size: 2rem;
            font-weight: bold;
            letter-spacing: 1px;
            position: relative;
        }

        .brand-name::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 3px;
            background-color: var(--accent-color);
            transition: width 0.5s ease;
        }

        .brand-name:hover::after {
            width: 100%;
        }

        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        .section-title {
            position: relative;
            display: inline-block;
            margin-bottom: 1.5rem;
            font-weight: 600;
        }

        .section-title::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: -5px;
            width: 60px;
            height: 3px;
            background-color: var(--primary-color);
            transition: width 0.3s ease;
        }

        .section-title:hover::after {
            width: 100%;
        }

        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--white);
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background-color: var(--primary-color);
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15);
        }

        .stat-card:hover::before {
            transform: scaleX(1);
        }

        .stat-card h4 {
            color: var(--text-color);
            margin-bottom: 0.5rem;
            font-size: 1.2rem;
            font-weight: 500;
        }

        .stat-card .amount {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
            transition: transform 0.3s ease;
        }

        .stat-card:hover .amount {
            transform: scale(1.1);
        }

        .table-container {
            background-color: var(--white);
            border-radius: 12px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            margin-bottom: 2rem;
            transition: transform 0.3s ease;
        }

        .table-container:hover {
            transform: translateY(-5px);
        }

        .table thead {
            background-color: var(--primary-color);
            color: var(--white);
        }

        .table th, .table td {
            padding: 1rem;
            vertical-align: middle;
        }

        .table tbody tr {
            transition: background-color 0.3s ease;
        }

        .table tbody tr:hover {
            background-color: rgba(13, 148, 136, 0.1);
        }

        .btn-custom {
            padding: 0.5rem 1rem;
            border-radius: 6px;
            transition: all 0.3s ease;
        }

        .btn-warning, .btn-danger {
            position: relative;
            overflow: hidden;
        }

        .btn-warning::before, .btn-danger::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.5s, height 0.5s;
            z-index: 0;
        }

        .btn-warning:hover::before, .btn-danger:hover::before {
            width: 300%;
            height: 300%;
        }

        .btn-warning:hover, .btn-danger:hover {
            opacity: 0.9;
        }

        .pagination {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 1.5rem;
        }

        .pagination button {
            padding: 0.5rem 1rem;
            border: 1px solid var(--primary-color);
            background: var(--white);
            color: var(--primary-color);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .pagination button:hover {
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        .pagination button.active {
            background: var(--primary-color);
            color: var(--white);
        }

        .search-container {
            background-color: var(--white);
            border-radius: 12px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
            transition: all 0.3s ease;
        }

        .search-container:hover {
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }

        .form-control, .form-select {
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            padding: 0.75rem;
            transition: all 0.3s ease;
        }

        .form-control:focus, .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(13, 148, 136, 0.2);
        }

        .filter-badge {
            display: inline-block;
            padding: 0.35rem 0.75rem;
            background-color: var(--primary-color);
            color: white;
            border-radius: 20px;
            margin: 0.25rem;
            font-size: 0.75rem;
            transition: all 0.3s ease;
        }

        .filter-badge i {
            margin-left: 0.25rem;
            cursor: pointer;
        }

        .filter-badge:hover {
            background-color: var(--primary-dark);
        }

        .month-year-header {
            background-color: #f1f5f9;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .month-year-header:hover {
            background-color: #e2e8f0;
        }

        .toggle-btn {
            background: none;
            border: none;
            color: var(--primary-color);
            font-size: 1.2rem;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .toggle-btn:hover {
            transform: scale(1.2);
        }

        .expense-group {
            margin-bottom: 1.5rem;
        }

        .message-container {
            position: fixed;
            top: 80px;
            right: 20px;
            z-index: 1001;
            max-width: 300px;
        }

        .message {
            padding: 1rem;
            margin-bottom: 1rem;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            animation: slideInRight 0.5s forwards;
        }

        .message.success {
            background-color: #d1fae5;
            border-left: 5px solid #10b981;
        }

        .message.error {
            background-color: #fee2e2;
            border-left: 5px solid #ef4444;
        }

        .message.info {
            background-color: #dbeafe;
            border-left: 5px solid #3b82f6;
        }

        /* .message-close {
            float: right;
            cursor: pointer;
            font-weight: bold;
        } */
        .message {
                padding: 10px;
                margin: 10px 0;
                border-radius: 5px;
                position: relative;
                background: #d4edda; /* Example success background */
                color: #155724;
                border: 1px solid #c3e6cb;
            }
            
            .message-close {
                position: absolute;
                top: 5px;
                right: 10px;
                cursor: pointer;
                font-size: 18px;
            }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Charts and Data Viz */
        .chart-container {
            background-color: var(--white);
            border-radius: 12px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            margin-bottom: 2rem;
            transition: transform 0.3s ease;
        }

        .chart-container:hover {
            transform: translateY(-5px);
        }

        .category-legend {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem;
            border-radius: 6px;
            transition: transform 0.3s ease;
            cursor: pointer;
        }

        .legend-item:hover {
            transform: translateY(-2px);
            background-color: rgba(13, 148, 136, 0.1);
        }

        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
        }

        /* Quick Actions Fab Button */
        .fab-container {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 999;
        }

        .fab-button {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: var(--primary-color);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .fab-button:hover {
            transform: scale(1.1);
            background-color: var(--primary-dark);
        }

        .fab-options {
            position: absolute;
            bottom: 70px;
            right: 0;
            display: none;
            flex-direction: column;
            gap: 1rem;
        }

        .fab-option {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background-color: white;
            color: var(--text-color);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transform: translateY(20px);
            opacity: 0;
            transition: transform 0.3s ease, opacity 0.3s ease;
        }

        .fab-option:hover {
            background-color: #f1f5f9;
        }

        .fab-option.show {
            transform: translateY(0);
            opacity: 1;
        }

        .fab-options.show {
            display: flex;
        }

        @media (max-width: 768px) {
            .stats-cards {
                grid-template-columns: 1fr;
            }
            .header {
                padding: 1rem;
            }
            .brand-name {
                font-size: 1.6rem;
            }
            .fab-container {
                bottom: 20px;
                right: 20px;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="logo-container">
            <img src="data:image/png;base64,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" alt="FinSage Logo" style="height: 50px; margin-right: 10px;">
            <span class="brand-name">FinSage</span>
        </div>
        <nav class="navbar navbar-expand-lg">
            <div class="container-fluid">
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle text-white" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="fas fa-user-circle me-1"></i> My Account
                            </a>
                            <ul class="dropdown-menu dropdown-menu-end">
                                <li><a class="dropdown-item" href="{% url 'finances:upload_bill' %}"><i class="fas fa-receipt me-2"></i>Upload Bill</a></li>
                                <li><a class="dropdown-item" href="{% url 'finances:export_expenses' %}"><i class="fas fa-file-export me-2"></i>Export Expenses</a></li>
                                <li><a class="dropdown-item" href="{% url 'finances:add_income' %}"><i class="fas fa-plus-circle me-2"></i>Add Income</a></li>
                                <li><a class="dropdown-item" href="{% url 'finances:add_expense' %}"><i class="fas fa-minus-circle me-2"></i>Add Expense</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item text-danger" href="/logout"><i class="fas fa-sign-out-alt me-2"></i>Logout</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <div class="container">
        <h1 class="section-title animate__animated animate__fadeIn"> Dashboard</h1>

        <div id="message-container" class="message-container">
            {% if messages %}
                {% for message in messages %}
                    {% if forloop.last %}
                        <div class="message {{ message.tags }} animate__animated animate__fadeIn">
                            <span class="message-close" onclick="closeMessage(this)">&times;</span>
                            {{ message }}
                        </div>
                    {% endif %}
                {% endfor %}
            {% endif %}
        </div>
        
        <script>
            function closeMessage(closeBtn) {
                let messageDiv = closeBtn.parentElement;
                messageDiv.classList.add("animate__fadeOut"); // Add fade-out animation
                setTimeout(() => messageDiv.style.display = "none", 100); // Hide after animation
            }
        </script>
        

        <div class="stats-cards animate__animated animate__fadeInUp">
            <div class="stat-card" id="income-card">
                <h4>Total Income</h4>
                <div class="amount" id="income-counter">₹{{ total_income }}</div>
                <!-- <div class="mt-2 text-success"><i class="fas fa-arrow-up me-1"></i><span id="income-percent">4.2</span>% from last month</div> -->
            </div>
            <div class="stat-card" id="expense-card">
                <h4>Total Expenses</h4>
                <div class="amount" id="expense-counter">₹{{ total_expenses }}</div>
                <!-- <div class="mt-2 text-danger"><i class="fas fa-arrow-up me-1"></i><span id="expense-percent">3.1</span>% from last month</div> -->
            </div>
            <div class="stat-card" id="balance-card">
                <h4>Balance</h4>
                <div class="amount" id="balance-counter">₹{{ balance }}</div>
                <!-- <div class="mt-2" id="balance-trend">
                    <span class="text-success"><i class="fas fa-arrow-up me-1"></i>5.3% from last month</span>
                </div> -->
            </div>
        </div>

        <!-- Charts Row -->
        <div class="row mb-4 animate__animated animate__fadeIn">
            <div class="col-md-6">
                <div class="chart-container">
                    <h5>Monthly Expenses by Category</h5>
                    <canvas id="categoryChart" width="400" height="250"></canvas>
                    <div class="category-legend" id="categoryLegend"></div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="chart-container">
                    <h5>Income vs Expenses Trend</h5>
                    <canvas id="trendChart" width="400" height="250"></canvas>
                </div>
            </div>
        </div>

        <h3 class="section-title animate__animated animate__fadeIn">Income Entries</h3>
        <div class="table-container animate__animated animate__fadeInUp">
            <div class="table-responsive">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Amount</th>
                            <th>Description</th>
                            <th>Date</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% if incomes %}
                            {% for income in incomes %}
                                <tr class="animate__animated animate__fadeIn" style="--animate-delay: {{ forloop.counter }}00ms">
                                    <td>₹{{ income.amount }}</td>
                                    <td>{{ income.description }}</td>
                                    <td>{{ income.date }}</td>
                                    <td>
                                        <a href="{% url 'finances:edit_income' income.id %}" class="btn btn-warning btn-custom">
                                            <i class="fas fa-edit me-1"></i> Edit
                                        </a>
                                        <a href="{% url 'finances:delete_income' income.id %}" class="btn btn-danger btn-custom" onclick="return confirmDelete('income')">
                                            <i class="fas fa-trash me-1"></i> Delete
                                        </a>
                                    </td>
                                </tr>
                            {% endfor %}
                        {% else %}
                            <tr>
                                <td colspan="4" class="text-center">No income entries found.</td>
                            </tr>
                        {% endif %}
                    </tbody>
                </table>
            </div>
        </div>

        <h3 class="section-title mt-4 animate__animated animate__fadeIn">Expense Management</h3>

        <div id="search-section" class="search-container p-3 animate__animated animate__fadeIn">
            <h5 class="mb-3"><i class="fas fa-filter me-2"></i>Filter Expenses</h5>
            <form method="GET" action="" class="row g-2">
                <div class="col-md-4">
                    <label for="month" class="form-label">Month</label>
                    <select name="month" id="month" class="form-select">
                        <option value="">All Months</option>
                        <option value="1">January</option>
                        <option value="2">February</option>
                        <option value="3">March</option>
                        <option value="4">April</option>
                        <option value="5">May</option>
                        <option value="6">June</option>
                        <option value="7">July</option>
                        <option value="8">August</option>
                        <option value="9">September</option>
                        <option value="10">October</option>
                        <option value="11">November</option>
                        <option value="12">December</option>
                    </select>
                </div>
        
                <div class="col-md-4">
                    <label for="year" class="form-label">Year</label>
                    <select name="year" id="year" class="form-select">
                        <option value="">All Years</option>
                        {% for year in available_years %}
                            <option value="{{ year }}">{{ year }}</option>
                        {% endfor %}
                    </select>
                </div>

                <div class="col-md-4">
                    <label for="date" class="form-label">Date</label>
                    <input type="date" name="date" id="date" class="form-control" placeholder="Search by date" value="{{ request.GET.date|default:'' }}">
                </div>
        
                <div class="col-md-4 d-flex align-items-end">
                    <button type="submit" class="btn btn-primary w-100"><i class="fas fa-search me-2"></i> Search</button>
                </div>
                <div class="col-md-2 d-flex align-items-end">
                    <a href="{% url 'finances:dashboard' %}" class="btn btn-secondary w-100">
                        <i class="fas fa-sync-alt me-2"></i> Reset
                    </a>
                </div>
            </form>

            <div class="active-filters mt-3" id="activeFilters">
                <!-- Active filters will be displayed here -->
            </div>
        </div>
    
        {% regroup expenses by month_year as expense_list %}
        
        {% for month_expenses in expense_list %}
        <div class="expense-group animate__animated animate__fadeIn" style="--animate-delay: {{ forloop.counter }}00ms">
            <div id="expense-{{ forloop.counter }}" class="collapse show">
                <div class="table-container">
                    <div class="table-responsive">
                        <table class="table mb-0">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Amount</th>
                                    <th>Description</th>
                                    <th>Category</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for expense in month_expenses.list %}
                                <tr>
                                    <td>{{ expense.date|date:"d M Y" }}</td>
                                    <td>₹{{ expense.amount }}</td>
                                    <td>{{ expense.description }}</td>
                                    <td>{{ expense.category.name }}</td>
                                    <td>
                                        <a href="{% url 'finances:edit_expense' expense.id %}" class="btn btn-warning btn-custom">
                                            <i class="fas fa-edit me-1"></i> Edit
                                        </a>
                                        <a href="{% url 'finances:delete_expense' expense.id %}" class="btn btn-danger btn-custom" onclick="return confirmDelete('expense')">
                                            <i class="fas fa-trash me-1"></i> Delete
                                        </a>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="expense-group animate__animated animate__fadeIn">
            <div class="table-container">
                <div class="table-responsive">
                    <table class="table mb-0">
                        <tbody>
                            <tr>
                                <td colspan="5" class="text-center">No expense entries found.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        {% endfor %}

        <div class="pagination animate__animated animate__fadeIn">
            {% if expenses.has_previous %}
                <button onclick="location.href='?page={{ expenses.previous_page_number }}&month={{ request.GET.month }}&year={{ request.GET.year }}&category={{ request.GET.category }}'">
                    <i class="fas fa-chevron-left me-1"></i> Previous
                </button>
            {% endif %}
            
            <button class="active">{{ expenses.number }}</button>
            
            {% if expenses.has_next %}
                <button onclick="location.href='?page={{ expenses.next_page_number }}&month={{ request.GET.month }}&year={{ request.GET.year }}&category={{ request.GET.category }}'">
                    Next <i class="fas fa-chevron-right ms-1"></i>
                </button>
            {% endif %}
        </div>
    </div>

<!-- Floating Action Button for Quick Actions -->
<div class="fab-container">
    <button class="fab-button" id="fabButton">
        <i class="fas fa-plus"></i>
    </button>
    <div class="fab-options" id="fabOptions">
        <div class="fab-option" onclick="window.location.href"={% url 'finances:add_income' %}>
            <i class="fas fa-plus-circle text-success"></i> Add Income
        </div>
        <div class="fab-option" onclick="window.location.href"={% url 'finances:add_expense' %}>
            <i class="fas fa-minus-circle text-danger"></i> Add Expense
        </div>
        <div class="fab-option" onclick="window.location.href"={% url 'finances:upload_bill' %}>
            <i class="fas fa-receipt text-primary"></i> Upload Bill
        </div>
        <div class="fab-option" onclick="window.location.href"={% url 'finances:export_expenses' %}>
            <i class="fas fa-file-export text-info"></i> Export Data
        </div>
    </div>
</div>
</div><div class="fab-container">
    <div class="fab-button" id="fabButton">
        <i class="fas fa-plus"></i>
    </div>
    <div class="fab-options" id="fabOptions">
        <div class="fab-option" onclick="location.href"='{% url 'finances:add_income' %}'>
            <i class="fas fa-plus-circle text-success"></i> Add Income
        </div>
        <div class="fab-option" onclick="location.href"='{% url 'finances:add_expense' %}'>
            <i class="fas fa-minus-circle text-danger"></i> Add Expense
        </div>
        <div class="fab-option" onclick="location.href"='{% url 'finances:upload_bill' %}'>
            <i class="fas fa-receipt text-primary"></i> Upload Bill
        </div>
        <div class="fab-option" onclick="location.href"='{% url 'finances:export_expenses' %}'>
            <i class="fas fa-file-export text-info"></i> Export Data
        </div>
    </div>
</div>

<script>
    const fabButton = document.getElementById('fabButton');
    const fabOptions = document.getElementById('fabOptions');

    fabButton.addEventListener('click', () => {
        fabOptions.classList.toggle('show');
    });

    document.addEventListener('click', (e) => {
        if (!fabButton.contains(e.target) && !fabOptions.contains(e.target)) {
            fabOptions.classList.remove('show');
        }
    });
</script>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        // Initialize counters
        initializeCounters();
        // Initialize charts
        initializeCharts();
        // Handle filters
        handleFilters();
        // Handle FAB button
        handleFabButton();
        // Handle messages
        handleMessages();
    });
    
    // Counter animation for stats
    function initializeCounters() {
        animateCounter('income-counter');
        animateCounter('expense-counter');
        animateCounter('balance-counter');
        // Update balance trend color
        const balanceTrend = document.getElementById('balance-trend');
        if (parseFloat(document.getElementById('balance-counter').innerText.replace('₹', '')) > 0) {
            balanceTrend.innerHTML = '<span class="text-success"><i class="fas fa-arrow-up me-1"></i>5.3% from last month</span>';
        } else {
            balanceTrend.innerHTML = '<span class="text-danger"><i class="fas fa-arrow-down me-1"></i>3.7% from last month</span>';
        }
    }
    
    function animateCounter(elementId) {
        const element = document.getElementById(elementId);
        if (!element) return;
        const value = parseFloat(element.innerText.replace('₹', '').replace(/,/g, ''));
        let startValue = 0;
        const duration = 1500;
        const increment = Math.ceil(value / (duration / 20));
        const startTime = performance.now();
    
        function updateCounter(timestamp) {
            const elapsed = timestamp - startTime;
            const progress = Math.min(elapsed / duration, 1);
            const currentValue = Math.floor(progress * value);
            element.innerText = '₹' + currentValue.toLocaleString();
            if (progress < 1) {
                requestAnimationFrame(updateCounter);
            }
        }
        
        requestAnimationFrame(updateCounter);
    }
    
    // Initialize charts
    function initializeCharts() {
        // Income vs Expense Chart
        const overviewCtx = document.getElementById('overview-chart').getContext('2d');
        const overviewChart = new Chart(overviewCtx, {
            type: 'bar',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                datasets: [
                    {
                        label: 'Income',
                        data: [65000, 59000, 80000, 81000, 56000, 75000],
                        backgroundColor: 'rgba(40, 167, 69, 0.7)',
                        borderColor: 'rgba(40, 167, 69, 1)',
                        borderWidth: 1
                    },
                    {
                        label: 'Expenses',
                        data: [45000, 49000, 60000, 51000, 46000, 55000],
                        backgroundColor: 'rgba(220, 53, 69, 0.7)',
                        borderColor: 'rgba(220, 53, 69, 1)',
                        borderWidth: 1
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return '₹' + value.toLocaleString();
                            }
                        }
                    }
                }
            }
        });
    
        // Expense categories chart
        const categoryCtx = document.getElementById('category-chart').getContext('2d');
        const categoryChart = new Chart(categoryCtx, {
            type: 'doughnut',
            data: {
                labels: ['Housing', 'Food', 'Transport', 'Entertainment', 'Utilities', 'Others'],
                datasets: [{
                    data: [35, 20, 15, 10, 12, 8],
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.7)',
                        'rgba(54, 162, 235, 0.7)',
                        'rgba(255, 206, 86, 0.7)',
                        'rgba(75, 192, 192, 0.7)',
                        'rgba(153, 102, 255, 0.7)',
                        'rgba(255, 159, 64, 0.7)'
                    ],
                    borderColor: [
                        'rgba(255, 99, 132, 1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)',
                        'rgba(255, 159, 64, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false
            }
        });
    }
    
    // Handle filters
    function handleFilters() {
        const dateFilter = document.getElementById('date-filter');
        const categoryFilter = document.getElementById('category-filter');
        
        if (dateFilter) {
            dateFilter.addEventListener('change', function() {
                updateDashboardData(this.value, categoryFilter.value);
            });
        }
        
        if (categoryFilter) {
            categoryFilter.addEventListener('change', function() {
                updateDashboardData(dateFilter.value, this.value);
            });
        }
    }
    
    function updateDashboardData(dateRange, category) {
        // Simulate API call with setTimeout
        const loadingIndicator = document.getElementById('loading-indicator');
        if (loadingIndicator) loadingIndicator.classList.remove('d-none');
        
        setTimeout(() => {
            // Update counters based on filter
            let incomeValue, expenseValue, balanceValue;
            
            switch(dateRange) {
                case 'this-month':
                    incomeValue = 75000;
                    expenseValue = 55000;
                    break;
                case 'last-month':
                    incomeValue = 81000;
                    expenseValue = 51000;
                    break;
                case 'last-3-months':
                    incomeValue = 211000;
                    expenseValue = 157000;
                    break;
                default:
                    incomeValue = 75000;
                    expenseValue = 55000;
            }
            
            balanceValue = incomeValue - expenseValue;
            
            document.getElementById('income-counter').innerText = '₹' + incomeValue.toLocaleString();
            document.getElementById('expense-counter').innerText = '₹' + expenseValue.toLocaleString();
            document.getElementById('balance-counter').innerText = '₹' + balanceValue.toLocaleString();
            
            // Re-initialize counters to animate
            initializeCounters();
            
            // Update transaction list based on category filter
            updateTransactionList(category);
            
            // Hide loading indicator
            if (loadingIndicator) loadingIndicator.classList.add('d-none');
        }, 800);
    }
    
    function updateTransactionList(category) {
        const transactionList = document.getElementById('transaction-list');
        if (!transactionList) return;
        
        const transactions = [
            { date: '2025-02-18', description: 'Salary', amount: 58000, type: 'income', category: 'salary' },
            { date: '2025-02-17', description: 'Rent Payment', amount: 20000, type: 'expense', category: 'housing' },
            { date: '2025-02-15', description: 'Grocery Shopping', amount: 3500, type: 'expense', category: 'food' },
            { date: '2025-02-14', description: 'Freelance Work', amount: 15000, type: 'income', category: 'freelance' },
            { date: '2025-02-12', description: 'Electricity Bill', amount: 2800, type: 'expense', category: 'utilities' },
            { date: '2025-02-10', description: 'Restaurant Dinner', amount: 2200, type: 'expense', category: 'food' },
            { date: '2025-02-08', description: 'Fuel', amount: 1500, type: 'expense', category: 'transport' },
            { date: '2025-02-05', description: 'Movie Tickets', amount: 800, type: 'expense', category: 'entertainment' }
        ];
        
        // Filter transactions by category if specified
        const filteredTransactions = category === 'all' ? 
            transactions : 
            transactions.filter(t => t.category === category);
        
        // Clear existing list
        transactionList.innerHTML = '';
        
        // Add filtered transactions
        if (filteredTransactions.length === 0) {
            transactionList.innerHTML = '<div class="text-center py-4">No transactions found</div>';
            return;
        }
        
        filteredTransactions.forEach(transaction => {
            const listItem = document.createElement('div');
            listItem.className = 'transaction-item p-3 border-bottom';
            
            const amountClass = transaction.type === 'income' ? 'text-success' : 'text-danger';
            const amountPrefix = transaction.type === 'income' ? '+' : '-';
            
            listItem.innerHTML = `
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="mb-1">${transaction.description}</h6>
                        <small class="text-muted">${formatDate(transaction.date)}</small>
                    </div>
                    <div class="fw-bold ${amountClass}">
                        ${amountPrefix}₹${transaction.amount.toLocaleString()}
                    </div>
                </div>
            `;
            
            transactionList.appendChild(listItem);
        });
    }
    
    function formatDate(dateString) {
        const options = { year: 'numeric', month: 'short', day: 'numeric' };
        return new Date(dateString).toLocaleDateString(undefined, options);
    }
    
    // Handle FAB button
    function handleFabButton() {
        const fabButton = document.getElementById('add-transaction-fab');
        const modal = document.getElementById('add-transaction-modal');
        
        if (fabButton && modal) {
            fabButton.addEventListener('click', function() {
                const modalInstance = new bootstrap.Modal(modal);
                modalInstance.show();
            });
        }
        
        // Handle form submission
        const transactionForm = document.getElementById('add-transaction-form');
        if (transactionForm) {
            transactionForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Get form data
                const formData = new FormData(this);
                const transactionData = {
                    type: formData.get('transaction-type'),
                    category: formData.get('transaction-category'),
                    amount: parseFloat(formData.get('transaction-amount')),
                    description: formData.get('transaction-description'),
                    date: formData.get('transaction-date')
                };
                
                // Add new transaction to list
                addNewTransaction(transactionData);
                
                // Close modal
                bootstrap.Modal.getInstance(modal).hide();
                
                // Show success message
                showNotification('Transaction added successfully!', 'success');
                
                // Reset form
                this.reset();
            });
        }
    }
    
    function addNewTransaction(transaction) {
        // Update counters based on transaction type
        const incomeCounter = document.getElementById('income-counter');
        const expenseCounter = document.getElementById('expense-counter');
        const balanceCounter = document.getElementById('balance-counter');
        
        if (incomeCounter && expenseCounter && balanceCounter) {
            let currentIncome = parseFloat(incomeCounter.innerText.replace('₹', '').replace(/,/g, ''));
            let currentExpense = parseFloat(expenseCounter.innerText.replace('₹', '').replace(/,/g, ''));
            
            if (transaction.type === 'income') {
                currentIncome += transaction.amount;
                incomeCounter.innerText = '₹' + currentIncome.toLocaleString();
            } else {
                currentExpense += transaction.amount;
                expenseCounter.innerText = '₹' + currentExpense.toLocaleString();
            }
            
            // Update balance
            const newBalance = currentIncome - currentExpense;
            balanceCounter.innerText = '₹' + newBalance.toLocaleString();
            
            // Update trend indicator
            updateBalanceTrend(newBalance);
        }
        
        // Add to transaction list
        const transactionList = document.getElementById('transaction-list');
        if (transactionList) {
            const listItem = document.createElement('div');
            listItem.className = 'transaction-item p-3 border-bottom animate__animated animate__fadeIn';
            
            const amountClass = transaction.type === 'income' ? 'text-success' : 'text-danger';
            const amountPrefix = transaction.type === 'income' ? '+' : '-';
            
            listItem.innerHTML = `
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="mb-1">${transaction.description}</h6>
                        <small class="text-muted">${formatDate(transaction.date)}</small>
                    </div>
                    <div class="fw-bold ${amountClass}">
                        ${amountPrefix}₹${transaction.amount.toLocaleString()}
                    </div>
                </div>
            `;
            
            // Add as first item
            if (transactionList.firstChild) {
                transactionList.insertBefore(listItem, transactionList.firstChild);
            } else {
                transactionList.appendChild(listItem);
            }
        }
    }
    
    function updateBalanceTrend(newBalance) {
        const balanceTrend = document.getElementById('balance-trend');
        if (balanceTrend) {
            if (newBalance > 0) {
                balanceTrend.innerHTML = '<span class="text-success"><i class="fas fa-arrow-up me-1"></i>5.3% from last month</span>';
            } else {
                balanceTrend.innerHTML = '<span class="text-danger"><i class="fas fa-arrow-down me-1"></i>3.7% from last month</span>';
            }
        }
    }
    
    function showNotification(message, type = 'info') {
        const notificationContainer = document.getElementById('notification-container');
        if (!notificationContainer) {
            // Create notification container if it doesn't exist
            const container = document.createElement('div');
            container.id = 'notification-container';
            container.className = 'position-fixed bottom-0 end-0 p-3';
            document.body.appendChild(container);
        }
        
        const notificationId = 'notification-' + Date.now();
        const notification = document.createElement('div');
        notification.className = `toast align-items-center text-white bg-${type} border-0`;
        notification.setAttribute('role', 'alert');
        notification.setAttribute('aria-live', 'assertive');
        notification.setAttribute('aria-atomic', 'true');
        notification.id = notificationId;
        
        notification.innerHTML = `
            <div class="d-flex">
                <div class="toast-body">
                    ${message}
                </div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
        `;
        
        document.getElementById('notification-container').appendChild(notification);
        
        const toast = new bootstrap.Toast(notification, {
            autohide: true,
            delay: 3000
        });
        
        toast.show();
        
        // Remove after hidden
        notification.addEventListener('hidden.bs.toast', function() {
            this.remove();
        });
    }
    
    // Handle messages
    function handleMessages() {
        const messageForm = document.getElementById('message-form');
        const messageInput = document.getElementById('message-input');
        const messageList = document.getElementById('message-list');
        
        if (messageForm && messageInput && messageList) {
            messageForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const message = messageInput.value.trim();
                if (message === '') return;
                
                // Add user message
                addMessage(message, 'user');
                
                // Clear input
                messageInput.value = '';
                
                // Simulate response after delay
                setTimeout(() => {
                    // Show typing indicator
                    const typingIndicator = document.createElement('div');
                    typingIndicator.className = 'message-item typing-indicator';
                    typingIndicator.innerHTML = '<div class="message-bubble assistant-bubble"><span class="dot"></span><span class="dot"></span><span class="dot"></span></div>';
                    messageList.appendChild(typingIndicator);
                    
                    // Scroll to bottom
                    messageList.scrollTop = messageList.scrollHeight;
                    
                    // Remove typing indicator and add response after delay
                    setTimeout(() => {
                        typingIndicator.remove();
                        
                        // Generate appropriate response based on message content
                        let response;
                        if (message.toLowerCase().includes('balance')) {
                            const balance = document.getElementById('balance-counter').innerText;
                            response = `Your current balance is ${balance}. Need help managing your finances?`;
                        } else if (message.toLowerCase().includes('income') || message.toLowerCase().includes('earning')) {
                            const income = document.getElementById('income-counter').innerText;
                            response = `Your total income this month is ${income}. Want to explore ways to increase your income?`;
                        } else if (message.toLowerCase().includes('expense') || message.toLowerCase().includes('spending')) {
                            const expense = document.getElementById('expense-counter').innerText;
                            response = `Your total expenses this month are ${expense}. I can help you analyze where you're spending the most.`;
                        } else if (message.toLowerCase().includes('help')) {
                            response = `I can help you track your finances, analyze spending patterns, and provide budgeting advice. What would you like to know?`;
                        } else {
                            response = `Thanks for your message. Our financial advisor will review your query and get back to you soon. Is there anything specific about your finances you'd like to know?`;
                        }
                        
                        addMessage(response, 'assistant');
                    }, 1500);
                }, 500);
            });
        }
    }
    
    function addMessage(content, sender) {
        const messageList = document.getElementById('message-list');
        if (!messageList) return;
        
        const messageItem = document.createElement('div');
        messageItem.className = `message-item ${sender}-message`;
        
        const bubbleClass = sender === 'user' ? 'user-bubble' : 'assistant-bubble';
        
        messageItem.innerHTML = `
            <div class="message-bubble ${bubbleClass}">
                ${content}
                <small class="message-time">${getCurrentTime()}</small>
            </div>
        `;
        
        messageList.appendChild(messageItem);
        
        // Scroll to bottom
        messageList.scrollTop = messageList.scrollHeight;
    }
    
    function getCurrentTime() {
        const now = new Date();
        return now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
    }
</script>
</body>
</html>